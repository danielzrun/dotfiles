# =============================================================================
# .zshrc - Interactive shell configuration
# =============================================================================
# Executed for each new interactive shell
# Used for: aliases, plugins, prompts, key bindings
# =============================================================================

# -----------------------------------------------------------------------------
# Oh My Zsh Configuration
# -----------------------------------------------------------------------------
export ZSH="$HOME/.oh-my-zsh"
ZSH_THEME=""  # Using Starship instead

# Custom completion paths
if [[ -d "$HOME/.docker/completions" ]]; then
  fpath=("$HOME/.docker/completions" $fpath)
fi

# Plugins (order matters!)
plugins=(
  git                      # Git aliases and completion
  vi-mode                  # Vim mode (better than bindkey -v)
  uv                       # uv completion
  direnv                   # Per-directory environment variables
  zoxide                   # Smart directory jumper
  fzf                      # Fuzzy finder integration
  zsh-completions          # Additional completions (must be before compinit)
  zsh-autosuggestions      # Command suggestions
  fzf-tab                  # FZF integration (must be after compinit, before highlighting)
  zsh-syntax-highlighting  # Syntax highlighting (MUST be last)
)

source $ZSH/oh-my-zsh.sh

# -----------------------------------------------------------------------------
# Shell Options
# -----------------------------------------------------------------------------

# Window Title
# Set window title to current directory instead of hostname
case $TERM in
  xterm*|tmux*|screen*)
    precmd() {
      print -Pn "\e]0;%~\a"
    }
    ;;
esac

# History
HISTSIZE=50000
SAVEHIST=50000
HISTFILE="$HOME/.zsh_history"

# Deduplication (keeps .zsh_history text file clean)
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_FIND_NO_DUPS
setopt HIST_SAVE_NO_DUPS

# Write after each command (prevents loss on terminal crash)
setopt INC_APPEND_HISTORY

# Share history across terminal tabs (works alongside Atuin)
setopt SHARE_HISTORY

# -----------------------------------------------------------------------------
# Modules & Functions
# -----------------------------------------------------------------------------
# Core shell behavior
{{ template "zsh/vi-mode.zsh" . }}
{{ template "zsh/keybindings.zsh" . }}

# Development tools (must load before aliases/functions that depend on them)
{{ template "zsh/modern-tools.zsh" . }}
{{ template "zsh/python.zsh" . }}
{{ template "zsh/node.zsh" . }}

# User utilities (can reference tools loaded above)
{{ template "zsh/functions.zsh" . }}
{{ template "zsh/aliases.zsh" . }}
