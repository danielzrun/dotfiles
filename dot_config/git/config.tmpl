# =============================================================================
# Git Configuration
# =============================================================================

[user]
    name = {{ .name }}
    email = {{ .email }}

[core]
    editor = nvim
    excludesfile = ~/.config/git/ignore
    ignorecase = false
    pager = delta

[init]
    defaultBranch = main

[color]
    ui = true

[alias]
    # Enhanced log
    lg = log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit
    ll = log --pretty=format:"%C(yellow)%h%Cred%d\\ %Creset%s%Cblue\\ [%cn]" --decorate --numstat

    # Cleanup
    clean-branches = "!git branch --merged | grep -v '\\*\\|main\\|master\\|develop' | xargs -n 1 git branch -d"

    # Search
    find = "!git ls-files | grep -i"
    grep = grep -Ii

    # History
    history = log --follow -p --

[pull]
    rebase = true

[include]
    path = ~/.config/git/delta-themes

[delta]
    # Theme and syntax highlighting
    features = catppuccin-mocha
    syntax-theme = Catppuccin Mocha
    # Display settings
    side-by-side = true
    line-numbers = true
    # Navigation
    navigate = true
    # Hunk styling with subtle background
    plus-style = "syntax #313244"
    minus-style = "syntax #313244"

[merge]
    conflictstyle = zdiff3
    stat = true
    tool = nvimdiff

[mergetool]
    prompt = false
    keepBackup = false

# Neovim-based terminal merge tool
[mergetool "nvimdiff"]
    cmd = nvim "$MERGED"

# Difftastic: Syntax-aware merge tool for semantic comparison
[mergetool "difftastic"]
    cmd = difft --color=always --display=side-by-side "$LOCAL" "$REMOTE"

[rerere]
    enabled = true
    autoupdate = true

[diff]
    renames = true
    colorMoved = default
    # Enable external to use difftastic for default git diff
    # Comment out to use delta for regular diffs, only use difftastic manually
    # external = difft

[difftool]
    prompt = false

[difftool "difftastic"]
    # Add --color=always for proper colors in terminal and lazygit
    cmd = difft --color=always "$LOCAL" "$REMOTE"

[pager]
    # Use delta for log and regular diffs (better line navigation)
    diff = delta
    log = delta
    reflog = delta
    show = delta

[interactive]
    # Delta is the best choice for interactive mode
    diffFilter = delta --color-only --features=catppuccin-mocha

{{- if eq .chezmoi.os "darwin" }}
[credential]
    helper = osxkeychain
{{- end }}
